{"remainingRequest":"/Users/huajuncheng/Documents/git-prj/vue-main-web/node_modules/babel-loader/lib/index.js!/Users/huajuncheng/Documents/git-prj/vue-main-web/node_modules/eslint-loader/index.js??ref--14-0!/Users/huajuncheng/Documents/git-prj/vue-main-web/src/permission.js","dependencies":[{"path":"/Users/huajuncheng/Documents/git-prj/vue-main-web/src/permission.js","mtime":1667785065886},{"path":"/Users/huajuncheng/Documents/git-prj/vue-main-web/babel.config.js","mtime":1666252172553},{"path":"/Users/huajuncheng/Documents/git-prj/vue-main-web/node_modules/cache-loader/dist/cjs.js","mtime":1663934044279},{"path":"/Users/huajuncheng/Documents/git-prj/vue-main-web/node_modules/babel-loader/lib/index.js","mtime":1663934044381},{"path":"/Users/huajuncheng/Documents/git-prj/vue-main-web/node_modules/eslint-loader/index.js","mtime":1665751372775}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHJvdXRlciBmcm9tICcuL3JvdXRlcic7CmltcG9ydCBOUHJvZ3Jlc3MgZnJvbSAnbnByb2dyZXNzJzsgLy8gcHJvZ3Jlc3MgYmFyCmltcG9ydCAnbnByb2dyZXNzL25wcm9ncmVzcy5jc3MnOyAvLyBwcm9ncmVzcyBiYXIgc3R5bGUKaW1wb3J0IHsgZ2V0VG9rZW4gfSBmcm9tICdAL3V0aWxzL2F1dGgnOyAvLyBnZXQgdG9rZW4gZnJvbSBjb29raWUKaW1wb3J0IFZ1ZXggZnJvbSAnQC9zdG9yZS9pbmRleCc7CmltcG9ydCB7IG1hdGNoIH0gZnJvbSAncGF0aC10by1yZWdleHAnOwpOUHJvZ3Jlc3MuY29uZmlndXJlKHsKICBzaG93U3Bpbm5lcjogZmFsc2UKfSk7IC8vIE5Qcm9ncmVzcyBDb25maWd1cmF0aW9uCgpjb25zdCByYXdBcHBlbmRDaGlsZCA9IEhUTUxIZWFkRWxlbWVudC5wcm90b3R5cGUuYXBwZW5kQ2hpbGQ7CmNvbnN0IHJhd0FkZEV2ZW50TGlzdGVuZXIgPSB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcjsKbGV0IHJhd0FwcGVuZENoaWxkU3ViQ29weSA9IG51bGw7CmxldCByYXdBZGRFdmVudExpc3RlbmVyU3ViQ29weSA9IG51bGw7CmNvbnN0IHdoaXRlTGlzdCA9IFsnL2xvZ2luJ107IC8vIG5vIHJlZGlyZWN0IHdoaXRlbGlzdAovLyDnlKjmnaXlpITnkIZxaWFua3VuIOS7juWtkOW6lOeUqOi3s+i9rOWIsOS4u+W6lOeUqCDml6Dms5XmuLLmn5PkuLvlupTnlKhjc3Plkoxqc+eahGJ1ZyDnu5PmnZ8KCnJvdXRlci5iZWZvcmVFYWNoKCh0bywgZnJvbSwgbmV4dCkgPT4gewogIC8vIHN0YXJ0IHByb2dyZXNzIGJhcgogIE5Qcm9ncmVzcy5zdGFydCgpOwoKICAvLyBkZXRlcm1pbmUgd2hldGhlciB0aGUgdXNlciBoYXMgbG9nZ2VkIGluCiAgY29uc3QgaGFzVG9rZW4gPSBnZXRUb2tlbigpOwogIGlmIChoYXNUb2tlbikgewogICAgY29uc29sZS5sb2coJ+aciXRva2VuJyk7CiAgICBpZiAodG8ucGF0aCA9PT0gJy9sb2dpbicpIHsKICAgICAgY29uc29sZS5sb2coJ3BhdGjmmK9sb2dpbicpOwogICAgICAvLyBpZiBpcyBsb2dnZWQgaW4sIHJlZGlyZWN0IHRvIHRoZSBob21lIHBhZ2UKICAgICAgbmV4dCh7CiAgICAgICAgcGF0aDogJy8nCiAgICAgIH0pOwogICAgICBOUHJvZ3Jlc3MuZG9uZSgpOyAvLyBoYWNrOiBodHRwczovL2dpdGh1Yi5jb20vUGFuSmlhQ2hlbi92dWUtZWxlbWVudC1hZG1pbi9wdWxsLzI5MzkKICAgIH0gZWxzZSB7CiAgICAgIGNvbnNvbGUubG9nKCflvIDlp4vpibTmnYNxaWFua3Vu6Lev55SxJyk7CiAgICAgIC8vIOiOt+WPluWFqOmHj+WKqOaAgei3r+eUsQogICAgICBjb25zdCBhbGxSb3V0ZXJQYXRoQXJyID0gVnVleC5zdGF0ZS5wZXJtaXNzaW9uLmFkZFBhdGhzIHx8IFtdOwogICAgICBjb25zdCBpc0NoaWxkUm91dGUgPSBwYXRoID0+IGFsbFJvdXRlclBhdGhBcnIuc29tZShpdGVtID0+IHsKICAgICAgICBjb25zdCBmbiA9IG1hdGNoKGl0ZW0sIHsKICAgICAgICAgIGRlY29kZTogZGVjb2RlVVJJQ29tcG9uZW50CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuICEhZm4ocGF0aCk7CiAgICAgIH0pOwogICAgICBjb25zb2xlLmxvZygn5byA5aeL6Ym05p2DcWlhbmt1bui3r+eUsee7k+adnycpOwogICAgICBpZiAoaXNDaGlsZFJvdXRlKGZyb20ucGF0aCkgJiYgIWlzQ2hpbGRSb3V0ZSh0by5wYXRoKSkgewogICAgICAgIGNvbnNvbGUubG9nKCfku47lrZDlupTnlKjot6/nlLHot7PovazliLDkuLvlupTnlKjot6/nlLEnKTsKICAgICAgICByYXdBcHBlbmRDaGlsZFN1YkNvcHkgPSBIVE1MSGVhZEVsZW1lbnQucHJvdG90eXBlLmFwcGVuZENoaWxkOwogICAgICAgIHJhd0FkZEV2ZW50TGlzdGVuZXJTdWJDb3B5ID0gd2luZG93LmFkZEV2ZW50TGlzdGVuZXI7CiAgICAgICAgSFRNTEhlYWRFbGVtZW50LnByb3RvdHlwZS5hcHBlbmRDaGlsZCA9IHJhd0FwcGVuZENoaWxkOwogICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyID0gcmF3QWRkRXZlbnRMaXN0ZW5lcjsKICAgICAgICBjb25zb2xlLmxvZygncWlhbmt1buaVtOS9k+e7k+adnycpOwogICAgICB9IGVsc2UgaWYgKCFpc0NoaWxkUm91dGUoZnJvbS5wYXRoKSAmJiBpc0NoaWxkUm91dGUodG8ucGF0aCkpIHsKICAgICAgICBpZiAocmF3QXBwZW5kQ2hpbGRTdWJDb3B5ICYmIHJhd0FkZEV2ZW50TGlzdGVuZXJTdWJDb3B5KSB7CiAgICAgICAgICBIVE1MSGVhZEVsZW1lbnQucHJvdG90eXBlLmFwcGVuZENoaWxkID0gcmF3QXBwZW5kQ2hpbGRTdWJDb3B5OwogICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIgPSByYXdBZGRFdmVudExpc3RlbmVyU3ViQ29weTsKICAgICAgICB9CiAgICAgICAgY29uc29sZS5sb2coJ3FpYW5rdW7mlbTkvZPnu5PmnZ8nKTsKICAgICAgfQogICAgICAvLyDnlKjmnaXlpITnkIZxaWFua3VuIOS7juWtkOW6lOeUqOi3s+i9rOWIsOS4u+W6lOeUqCDml6Dms5XmuLLmn5PkuLvlupTnlKhjc3Plkoxqc+eahGJ1ZyDnu5PmnZ8KICAgICAgbmV4dCgpOwogICAgfQogIH0gZWxzZSB7CiAgICAvKiBoYXMgbm8gdG9rZW4qLwogICAgY29uc29sZS5sb2coJ+ayoeaciXRva2VuJyk7CiAgICBpZiAod2hpdGVMaXN0LmluZGV4T2YodG8ucGF0aCkgIT09IC0xKSB7CiAgICAgIGNvbnNvbGUubG9nKCflnKjnmb3lkI3ljZUnKTsKICAgICAgLy8gaW4gdGhlIGZyZWUgbG9naW4gd2hpdGVsaXN0LCBnbyBkaXJlY3RseQogICAgICBuZXh0KCk7CiAgICB9IGVsc2UgewogICAgICAvLyBvdGhlciBwYWdlcyB0aGF0IGRvIG5vdCBoYXZlIHBlcm1pc3Npb24gdG8gYWNjZXNzIGFyZSByZWRpcmVjdGVkIHRvIHRoZSBsb2dpbiBwYWdlLgogICAgICBjb25zb2xlLmxvZygn5LiN5Zyo55m95ZCN5Y2VJywgdG8pOwogICAgICBuZXh0KGAvbG9naW5gKTsKICAgICAgTlByb2dyZXNzLmRvbmUoKTsKICAgIH0KICB9Cn0pOwpyb3V0ZXIuYWZ0ZXJFYWNoKCgpID0+IHsKICAvLyBmaW5pc2ggcHJvZ3Jlc3MgYmFyCiAgTlByb2dyZXNzLmRvbmUoKTsKfSk7"},{"version":3,"names":["router","NProgress","getToken","Vuex","match","configure","showSpinner","rawAppendChild","HTMLHeadElement","prototype","appendChild","rawAddEventListener","window","addEventListener","rawAppendChildSubCopy","rawAddEventListenerSubCopy","whiteList","beforeEach","to","from","next","start","hasToken","console","log","path","done","allRouterPathArr","state","permission","addPaths","isChildRoute","some","item","fn","decode","decodeURIComponent","indexOf","afterEach"],"sources":["/Users/huajuncheng/Documents/git-prj/vue-main-web/src/permission.js"],"sourcesContent":["import router from './router'\nimport NProgress from 'nprogress' // progress bar\nimport 'nprogress/nprogress.css' // progress bar style\nimport { getToken } from '@/utils/auth' // get token from cookie\nimport Vuex from '@/store/index'\nimport { match } from 'path-to-regexp'\nNProgress.configure({ showSpinner: false }) // NProgress Configuration\n\nconst rawAppendChild = HTMLHeadElement.prototype.appendChild\nconst rawAddEventListener = window.addEventListener\nlet rawAppendChildSubCopy = null\nlet rawAddEventListenerSubCopy = null\nconst whiteList = ['/login'] // no redirect whitelist\n// 用来处理qiankun 从子应用跳转到主应用 无法渲染主应用css和js的bug 结束\n\nrouter.beforeEach((to, from, next) => {\n  // start progress bar\n  NProgress.start()\n\n  // determine whether the user has logged in\n  const hasToken = getToken()\n\n  if (hasToken) {\n    console.log('有token')\n    if (to.path === '/login') {\n      console.log('path是login')\n      // if is logged in, redirect to the home page\n      next({ path: '/' })\n      NProgress.done() // hack: https://github.com/PanJiaChen/vue-element-admin/pull/2939\n    } else {\n      console.log('开始鉴权qiankun路由')\n      // 获取全量动态路由\n      const allRouterPathArr = Vuex.state.permission.addPaths || []\n      const isChildRoute = path => allRouterPathArr.some(item => {\n        const fn = match(item, { decode: decodeURIComponent })\n        return !!fn(path)\n      })\n      console.log('开始鉴权qiankun路由结束')\n      if (isChildRoute(from.path) && !isChildRoute(to.path)) {\n        console.log('从子应用路由跳转到主应用路由')\n        rawAppendChildSubCopy = HTMLHeadElement.prototype.appendChild\n        rawAddEventListenerSubCopy = window.addEventListener\n        HTMLHeadElement.prototype.appendChild = rawAppendChild\n        window.addEventListener = rawAddEventListener\n        console.log('qiankun整体结束')\n      } else if (!isChildRoute(from.path) && isChildRoute(to.path)) {\n        if (rawAppendChildSubCopy && rawAddEventListenerSubCopy) {\n          HTMLHeadElement.prototype.appendChild = rawAppendChildSubCopy\n          window.addEventListener = rawAddEventListenerSubCopy\n        }\n        console.log('qiankun整体结束')\n      }\n      // 用来处理qiankun 从子应用跳转到主应用 无法渲染主应用css和js的bug 结束\n      next()\n    }\n  } else {\n    /* has no token*/\n    console.log('没有token')\n    if (whiteList.indexOf(to.path) !== -1) {\n      console.log('在白名单')\n      // in the free login whitelist, go directly\n      next()\n    } else {\n      // other pages that do not have permission to access are redirected to the login page.\n      console.log('不在白名单', to)\n      next(`/login`)\n      NProgress.done()\n    }\n  }\n})\n\nrouter.afterEach(() => {\n  // finish progress bar\n  NProgress.done()\n})\n"],"mappings":"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"}]}